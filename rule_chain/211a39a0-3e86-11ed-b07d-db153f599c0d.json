{
  "entityType" : "RULE_CHAIN",
  "entity" : {
    "additionalInfo" : {
      "description" : ""
    },
    "configuration" : null,
    "createdTime" : 1664298132026,
    "debugMode" : false,
    "externalId" : null,
    "firstRuleNodeId" : {
      "entityType" : "RULE_NODE",
      "id" : "215260a1-3e86-11ed-b07d-db153f599c0d"
    },
    "id" : {
      "entityType" : "RULE_CHAIN",
      "id" : "211a39a0-3e86-11ed-b07d-db153f599c0d"
    },
    "name" : "StageZero Customised Root Rule Chain",
    "root" : false,
    "tenantId" : null,
    "type" : "CORE"
  },
  "metaData" : {
    "connections" : [ {
      "fromIndex" : 1,
      "toIndex" : 0,
      "type" : "Success"
    }, {
      "fromIndex" : 3,
      "toIndex" : 4,
      "type" : "Success"
    }, {
      "fromIndex" : 6,
      "toIndex" : 19,
      "type" : "False"
    }, {
      "fromIndex" : 6,
      "toIndex" : 40,
      "type" : "True"
    }, {
      "fromIndex" : 9,
      "toIndex" : 10,
      "type" : "Success"
    }, {
      "fromIndex" : 11,
      "toIndex" : 10,
      "type" : "Success"
    }, {
      "fromIndex" : 13,
      "toIndex" : 12,
      "type" : "True"
    }, {
      "fromIndex" : 13,
      "toIndex" : 22,
      "type" : "False"
    }, {
      "fromIndex" : 14,
      "toIndex" : 30,
      "type" : "Success"
    }, {
      "fromIndex" : 15,
      "toIndex" : 30,
      "type" : "Success"
    }, {
      "fromIndex" : 16,
      "toIndex" : 30,
      "type" : "Success"
    }, {
      "fromIndex" : 17,
      "toIndex" : 1,
      "type" : "Created"
    }, {
      "fromIndex" : 17,
      "toIndex" : 11,
      "type" : "Created"
    }, {
      "fromIndex" : 18,
      "toIndex" : 9,
      "type" : "Cleared"
    }, {
      "fromIndex" : 19,
      "toIndex" : 8,
      "type" : "Success"
    }, {
      "fromIndex" : 20,
      "toIndex" : 2,
      "type" : "REST API request"
    }, {
      "fromIndex" : 20,
      "toIndex" : 3,
      "type" : "RPC Request from Device"
    }, {
      "fromIndex" : 20,
      "toIndex" : 5,
      "type" : "Generate Report"
    }, {
      "fromIndex" : 20,
      "toIndex" : 6,
      "type" : "Post attributes"
    }, {
      "fromIndex" : 20,
      "toIndex" : 7,
      "type" : "Attributes Updated"
    }, {
      "fromIndex" : 20,
      "toIndex" : 17,
      "type" : "Inactivity Event"
    }, {
      "fromIndex" : 20,
      "toIndex" : 18,
      "type" : "Activity Event"
    }, {
      "fromIndex" : 20,
      "toIndex" : 21,
      "type" : "Other"
    }, {
      "fromIndex" : 20,
      "toIndex" : 22,
      "type" : "RPC Request to Device"
    }, {
      "fromIndex" : 20,
      "toIndex" : 31,
      "type" : "Post telemetry"
    }, {
      "fromIndex" : 20,
      "toIndex" : 32,
      "type" : "Alarm Cleared"
    }, {
      "fromIndex" : 20,
      "toIndex" : 33,
      "type" : "Entity Created"
    }, {
      "fromIndex" : 20,
      "toIndex" : 35,
      "type" : "Connect Event"
    }, {
      "fromIndex" : 20,
      "toIndex" : 36,
      "type" : "Disconnect Event"
    }, {
      "fromIndex" : 20,
      "toIndex" : 38,
      "type" : "RPC Request to Device"
    }, {
      "fromIndex" : 20,
      "toIndex" : 41,
      "type" : "RPC Delivered"
    }, {
      "fromIndex" : 20,
      "toIndex" : 41,
      "type" : "RPC Failed"
    }, {
      "fromIndex" : 20,
      "toIndex" : 41,
      "type" : "RPC Queued"
    }, {
      "fromIndex" : 20,
      "toIndex" : 41,
      "type" : "RPC Successful"
    }, {
      "fromIndex" : 20,
      "toIndex" : 41,
      "type" : "RPC Timeout"
    }, {
      "fromIndex" : 22,
      "toIndex" : 15,
      "type" : "Failure"
    }, {
      "fromIndex" : 22,
      "toIndex" : 16,
      "type" : "Success"
    }, {
      "fromIndex" : 23,
      "toIndex" : 28,
      "type" : "Success"
    }, {
      "fromIndex" : 24,
      "toIndex" : 20,
      "type" : "False"
    }, {
      "fromIndex" : 24,
      "toIndex" : 25,
      "type" : "True"
    }, {
      "fromIndex" : 25,
      "toIndex" : 20,
      "type" : "False"
    }, {
      "fromIndex" : 25,
      "toIndex" : 26,
      "type" : "True"
    }, {
      "fromIndex" : 26,
      "toIndex" : 20,
      "type" : "Success"
    }, {
      "fromIndex" : 27,
      "toIndex" : 24,
      "type" : "Success"
    }, {
      "fromIndex" : 29,
      "toIndex" : 28,
      "type" : "Success"
    }, {
      "fromIndex" : 33,
      "toIndex" : 34,
      "type" : "Device"
    }, {
      "fromIndex" : 35,
      "toIndex" : 37,
      "type" : "Success"
    }, {
      "fromIndex" : 36,
      "toIndex" : 37,
      "type" : "Success"
    }, {
      "fromIndex" : 38,
      "toIndex" : 14,
      "type" : "storeRPCLog"
    }, {
      "fromIndex" : 38,
      "toIndex" : 23,
      "type" : "setActivationDetails"
    }, {
      "fromIndex" : 38,
      "toIndex" : 29,
      "type" : "setBatterySOCMinimim"
    }, {
      "fromIndex" : 40,
      "toIndex" : 19,
      "type" : "Failure"
    }, {
      "fromIndex" : 40,
      "toIndex" : 19,
      "type" : "Success"
    } ],
    "firstNodeIndex" : 27,
    "nodes" : [ {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1508,
        "layoutY" : 1117
      },
      "configuration" : {
        "defaultTTL" : 0,
        "skipLatestPersistence" : false,
        "useServerTs" : false
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214bf800-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Save ConnType",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgTimeseriesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1167,
        "layoutY" : 1113
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.ConnType = 'NONE';\n\nmsgType = \"POST_TELEMETRY_REQUEST\";\n\nreturn {msg: newMsg, metadata: metadata, msgType: msgType};"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214e6900-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Set ConnType telemetry attribute",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1571,
        "layoutY" : 680
      },
      "configuration" : {
        "ruleChainId" : "7cb365f0-2f7e-11ed-aeba-e3dbc53fd55c"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214e9010-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "rest api request",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1368,
        "layoutY" : 388
      },
      "configuration" : {
        "jsScript" : "//return {msg: msg, metadata: metadata, msgType: msgType};\n\nvar rpcResponse = {};\nif (msg.method === \"getCurrentTime\"){\n   rpcResponse.serverTime = new Date().getTime();\n} else {\n   rpcResponse.message = \"Unknown RPC request method: \" + msg.method;  \n}\nreturn {msg: rpcResponse, metadata: metadata, msgType: msgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214eb720-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "RPC request transform",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1650,
        "layoutY" : 385
      },
      "configuration" : {
        "serviceIdMetaDataAttribute" : "serviceId",
        "sessionIdMetaDataAttribute" : "sessionId",
        "requestIdMetaDataAttribute" : "requestId"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214f7a70-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "reply",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.rpc.TbSendRPCReplyNode"
    }, {
      "additionalInfo" : {
        "description" : "Forwards message to the \"Generate Report\" rule chain",
        "layoutX" : 373,
        "layoutY" : 657
      },
      "configuration" : {
        "ruleChainId" : "fec87280-d51d-11ec-902f-6906a1b833ac"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214f7a71-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Generate Report",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "This identies a RPC call to the controller to update the SOC minimum value. We store the corresponding value in SHARED ATTRIBUTES in case the controller is reset and needs to initialise with last valid values.",
        "layoutX" : 996,
        "layoutY" : 116
      },
      "configuration" : {
        "messageNames" : [ "battery_SOC_minimum" ],
        "metadataNames" : [ ],
        "checkAllKeys" : true
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214fa180-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "is battery_SOC_minimum ?",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbCheckMessageNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1378,
        "layoutY" : 470
      },
      "configuration" : {
        "ruleChainId" : "39b052b0-3e86-11ed-b07d-db153f599c0d"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214fc890-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Attribute Save",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1674,
        "layoutY" : 117
      },
      "configuration" : {
        "ruleChainId" : "08338df0-12f4-11ed-aeba-e3dbc53fd55c"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "214fefa0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Attributes Processing",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1079,
        "layoutY" : 987
      },
      "configuration" : {
        "jsScript" : "msg = {};\nmsg.alarmState = 'green';\nmetadata = {};\nmsgType = \"POST_ATTRIBUTES_REQUEST\";\nreturn {msg: msg, metadata: metadata, msgType: msgType};"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "215016b0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Clear alarmState attribute",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1510,
        "layoutY" : 1061
      },
      "configuration" : {
        "scope" : "SERVER_SCOPE",
        "notifyDevice" : false
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21503dc0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Save alarmState attribute",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1183,
        "layoutY" : 1062
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.alarmState = 'red';\n\nmsgType = \"POST_ATTRIBUTES_REQUEST\";\n\nreturn {msg: newMsg, metadata: metadata, msgType: msgType};"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21508be0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Set alarmState attribute",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1749,
        "layoutY" : 750
      },
      "configuration" : {
        "ruleChainId" : "7cb365f0-2f7e-11ed-aeba-e3dbc53fd55c"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2150b2f0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Diagnostics RPC check",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1483,
        "layoutY" : 750
      },
      "configuration" : {
        "jsScript" : "if (msg.method == 'DiagnosticsCheck') {\n    return true;\n} else {\n    return false;\n}"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2150b2f1-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "is diagnostic test?",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 2162,
        "layoutY" : 675
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.rpcResult=\"OK - \";\nfor (var i in msg) {\n    newMsg.rpcResult = newMsg.rpcResult + \"|\" + i + \":\" + msg[i];\n}\nvar newMsgType = \"POST_TELEMETRY_REQUEST\";\nreturn {msg: newMsg, metadata: metadata, msgType: newMsgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2150da00-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "store to TD (Diagnostic)",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1752,
        "layoutY" : 908
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.rpcResult=\"FAIL - \";\nfor (var i in msg) {\n    newMsg.rpcResult = newMsg.rpcResult + \"|\" + i + \":\" + msg[i];\n}\nvar newMsgType = \"POST_TELEMETRY_REQUEST\";\nreturn {msg: newMsg, metadata: metadata, msgType: newMsgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2150da01-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "store RPC result (Diagnostic)",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1750,
        "layoutY" : 852
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.rpcResult=\"OK - \";\nfor (var i in msg) {\n    newMsg.rpcResult = newMsg.rpcResult + \"|\" + i + \":\" + msg[i];\n}\n\nvar newMsgType = \"POST_TELEMETRY_REQUEST\";\nreturn {msg: newMsg, metadata: metadata, msgType: newMsgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21510110-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "store RPC result (Diagnostic)",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 916,
        "layoutY" : 766
      },
      "configuration" : {
        "alarmDetailsBuildJs" : "/*var details = {};\ndetails.temperature = msg.temperature;\ndetails.count = prevDetails.count + 1;\nif (metadata.prevAlarmDetails) {\n    var prevDetails = JSON.parse(metadata.prevAlarmDetails);\n    details.count = prevDetails.count + 1;\n} else {\n    details.count = 1;\n}\n\nreturn details;\n*/\nvar details = {};\nif (metadata.prevAlarmDetails) {\n    details = JSON.parse(metadata.prevAlarmDetails);\n    //remove prevAlarmDetails from metadata\n    delete metadata.prevAlarmDetails;\n    //now metadata is the same as it comes IN this rule node\n}\n\n\nreturn details;\n",
        "useMessageAlarmData" : false,
        "overwriteAlarmDetails" : false,
        "alarmType" : "inactivityTimeout",
        "severity" : "CRITICAL",
        "propagate" : false,
        "relationTypes" : [ ],
        "propagateToOwner" : false,
        "propagateToOwnerHierarchy" : false,
        "propagateToTenant" : true,
        "dynamicSeverity" : false
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21510111-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Create inactivity alarm",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.action.TbCreateAlarmNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 819,
        "layoutY" : 849
      },
      "configuration" : {
        "alarmDetailsBuildJs" : "var details = {};\nif (metadata.prevAlarmDetails) {\n    details = JSON.parse(metadata.prevAlarmDetails);\n}\ndetails.clearedTemperature = msg.temperature;\n\nreturn details;\n/*var details = {};\nif (metadata.prevAlarmDetails) {\n    details = JSON.parse(metadata.prevAlarmDetails);\n    //remove prevAlarmDetails from metadata\n    delete metadata.prevAlarmDetails;\n    //now metadata is the same as it comes IN this rule node\n}\n\n\nreturn details;\n*/",
        "alarmType" : "inactivityTimeout"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21512820-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Clear inactivity Alarm",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.action.TbClearAlarmNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1389,
        "layoutY" : 116
      },
      "configuration" : {
        "scope" : "CLIENT_SCOPE",
        "notifyDevice" : "false"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21514f30-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Save Attributes",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 566,
        "layoutY" : 302
      },
      "configuration" : {
        "version" : 0
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21514f31-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Message Type Switch",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbMsgTypeSwitchNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1649,
        "layoutY" : 336
      },
      "configuration" : {
        "jsScript" : "return '\\nIncoming message:\\n' + JSON.stringify(msg) + '\\nIncoming metadata:\\n' + JSON.stringify(metadata);"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21514f32-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Log Other",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.action.TbLogNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1437,
        "layoutY" : 892
      },
      "configuration" : {
        "timeoutInSeconds" : 60
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21517640-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "RPC Call to Controller",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.rpc.TbSendRPCRequestNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 2156,
        "layoutY" : 600
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\n\nif (msg.method==\"updateState\") {\n    var myParams = JSON.parse(msg.params);\n\n    if (myParams.ActivateEssential > -1) {\n        newMsg.load_essential=myParams.ActivateEssential;\n    }\n    if (myParams.ActivateNonEssential > -1) {\n        newMsg.load_non_essential=myParams.ActivateNonEssential;\n    }\n} \nvar newMsgType = \"POST_ATTRIBUTES_REQUEST\";\nreturn {msg: newMsg, metadata: metadata, msgType: newMsgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2151eb70-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "if RPC activate parms",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 255,
        "layoutY" : 301
      },
      "configuration" : {
        "originatorTypes" : [ "ENTITY_GROUP" ]
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21521280-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Is Entity Group",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbOriginatorTypeFilterNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 319,
        "layoutY" : 109
      },
      "configuration" : {
        "messageTypes" : [ "POST_ATTRIBUTES_REQUEST", "RPC_CALL_FROM_SERVER_TO_DEVICE" ]
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21523990-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Post attributes or RPC request",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbMsgTypeFilterNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 627,
        "layoutY" : 108
      },
      "configuration" : {
        "entityGroupId" : null,
        "entityGroupIsMessageOriginator" : true
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "215260a0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Duplicate To Group Entities",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbDuplicateMsgToGroupNode"
    }, {
      "additionalInfo" : {
        "description" : "Process incoming messages from devices with the alarm rules defined in the device profile. Dispatch all incoming messages with \"Success\" relation type.",
        "layoutX" : 67,
        "layoutY" : 395
      },
      "configuration" : {
        "persistAlarmRulesState" : false,
        "fetchAlarmRulesStateOnStart" : false
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "215260a1-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Device Profile Node",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.profile.TbDeviceProfileNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 2524,
        "layoutY" : 560
      },
      "configuration" : {
        "scope" : "SHARED_SCOPE",
        "notifyDevice" : false
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21537210-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "save shared attr",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 2158,
        "layoutY" : 530
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\nnewMsg.battery_SOC_minimum=msg.params;\n\n \nvar newMsgType = \"POST_ATTRIBUTES_REQUEST\";\nreturn {msg: newMsg, metadata: metadata, msgType: newMsgType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2153e740-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "if Battery Min SOC parms",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 2569,
        "layoutY" : 876
      },
      "configuration" : {
        "defaultTTL" : 0,
        "skipLatestPersistence" : false,
        "useServerTs" : false
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2153e741-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "save telemtry",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgTimeseriesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1374,
        "layoutY" : 241
      },
      "configuration" : {
        "ruleChainId" : "b81166d0-0736-11ed-aeba-e3dbc53fd55c"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21540e50-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Telemetry processing",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 992,
        "layoutY" : 32
      },
      "configuration" : {
        "ruleChainId" : "3c305c00-f6f7-11ec-835e-155652c12fff"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21540e51-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Clear alarm",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 50,
        "layoutY" : 585
      },
      "configuration" : {
        "version" : 0
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21543560-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Is this Device?",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbOriginatorTypeSwitchNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 60,
        "layoutY" : 668
      },
      "configuration" : {
        "ruleChainId" : "35cdafb0-f658-11ec-835e-155652c12fff"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21548380-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Provisioning new controller defaults",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 690,
        "layoutY" : 942
      },
      "configuration" : {
        "jsScript" : "var newType = \"POST_ATTRIBUTES_REQUEST\"\r\nmsg.connectivity = \"connected\"\r\nreturn {msg: msg, metadata: metadata, msgType: newType};"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2154aa90-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Connect event to Server",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 588,
        "layoutY" : 1002
      },
      "configuration" : {
        "jsScript" : "var newType = \"POST_ATTRIBUTES_REQUEST\"\r\nmsg.connectivity = \"disconnected\"\r\nreturn {msg: msg, metadata: metadata, msgType: newType};"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2154d1a0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Disconnect event to server",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 881,
        "layoutY" : 1082
      },
      "configuration" : {
        "scope" : "SERVER_SCOPE",
        "notifyDevice" : false
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2154d1a1-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Save Server attribute",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1571,
        "layoutY" : 617
      },
      "configuration" : {
        "jsScript" : "if (msg.method==\"updateState\") {\n    var myParams = JSON.parse(msg.params);\n\n    if (myParams.ActivateEssential > -1 || myParams.ActivateNonEssential > -1) {\n        return ['setActivationDetails','storeRPCLog'];\n    } \n}\nif (msg.method==\"setBatterySOCMinimum\") {\n    return ['setBatterySOCMinimim','storeRPCLog'];\n}\n\nreturn ['storeRPCLog'];"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2154f8b0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "trap outg RPC calls",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.filter.TbJsSwitchNode"
    }, {
      "additionalInfo" : {
        "description" : "Send clear alarm api call to Solid",
        "layoutX" : 1403,
        "layoutY" : 22
      },
      "configuration" : {
        "jsScript" : "return {msg: msg, metadata: metadata, msgType: msgType};"
      },
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "2154f8b1-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "Alarm cleared",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1182,
        "layoutY" : 183
      },
      "configuration" : {
        "tellFailureIfAbsent" : true,
        "clientAttributeNames" : [ "battery_SOC_minimum" ],
        "sharedAttributeNames" : [ ],
        "serverAttributeNames" : [ ],
        "latestTsKeyNames" : [ ],
        "getLatestValueWithTs" : false
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21551fc0-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "get SOC minimum",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.metadata.TbGetAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1386,
        "layoutY" : 961
      },
      "configuration" : {
        "jsScript" : "return 'Incoming message:\\n' + JSON.stringify(msg) + '\\nIncoming metadata:\\n' + JSON.stringify(metadata);"
      },
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "21551fc1-3e86-11ed-b07d-db153f599c0d"
      },
      "name" : "rpc result",
      "ruleChainId" : null,
      "type" : "org.thingsboard.rule.engine.action.TbLogNode"
    } ],
    "ruleChainConnections" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}